<!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>2.&#xA0;main&#x51FD;&#x6570;&#x548C;&#x542F;&#x52A8;&#x4F8B;&#x7A0B;</title><link rel="stylesheet" href="styles.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.73.2"><link rel="start" href="index.html" title="Linux C&#x7F16;&#x7A0B;&#x4E00;&#x7AD9;&#x5F0F;&#x5B66;&#x4E60;"><link rel="up" href="ch19.html" title="&#x7B2C;&#xA0;19&#xA0;&#x7AE0;&#xA0;&#x6C47;&#x7F16;&#x4E0E;C&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;"><link rel="prev" href="ch19s01.html" title="1.&#xA0;&#x51FD;&#x6570;&#x8C03;&#x7528;"><link rel="next" href="ch19s03.html" title="3.&#xA0;&#x53D8;&#x91CF;&#x7684;&#x5B58;&#x50A8;&#x5E03;&#x5C40;"><meta name="viewport" content="width=device-width, initial-scale=1"></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tbody><tr><th colspan="3" align="center">2.&#xA0;<code class="literal">main</code>&#x51FD;&#x6570;&#x548C;&#x542F;&#x52A8;&#x4F8B;&#x7A0B;</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch19s01.html">&#x4E0A;&#x4E00;&#x9875;</a>&#xA0;</td><th width="60%" align="center">&#x7B2C;&#xA0;19&#xA0;&#x7AE0;&#xA0;&#x6C47;&#x7F16;&#x4E0E;C&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;</th><td width="20%" align="right">&#xA0;<a accesskey="n" href="ch19s03.html">&#x4E0B;&#x4E00;&#x9875;</a></td></tr></tbody></table><hr></div><div class="sect1" lang="zh-cn" xml:lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2776173"></a>2.&#xA0;<code class="literal">main</code>&#x51FD;&#x6570;&#x548C;&#x542F;&#x52A8;&#x4F8B;&#x7A0B;</h2></div></div></div><p>&#x4E3A;&#x4EC0;&#x4E48;&#x6C47;&#x7F16;&#x7A0B;&#x5E8F;&#x7684;&#x5165;&#x53E3;&#x662F;<code class="literal">_start</code>&#xFF0C;&#x800C;C&#x7A0B;&#x5E8F;&#x7684;&#x5165;&#x53E3;&#x662F;<code class="literal">main</code>&#x51FD;&#x6570;&#x5462;&#xFF1F;&#x672C;&#x8282;&#x5C31;&#x6765;&#x89E3;&#x91CA;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x3002;&#x5728;&#x8BB2;<a class="xref" href="ch18s01.html#asm.simpleasm">&#x4F8B;&#xA0;18.1 &#x201C;&#x6700;&#x7B80;&#x5355;&#x7684;&#x6C47;&#x7F16;&#x7A0B;&#x5E8F;&#x201D;</a>&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x7684;&#x6C47;&#x7F16;&#x548C;&#x94FE;&#x63A5;&#x6B65;&#x9AA4;&#x662F;&#xFF1A;</p><pre class="screen">$ as hello.s -o hello.o
$ ld hello.o -o hello</pre><p>&#x4EE5;&#x524D;&#x6211;&#x4EEC;&#x5E38;&#x7528;<code class="literal">gcc main.c -o main</code>&#x547D;&#x4EE4;&#x7F16;&#x8BD1;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#xFF0C;&#x5176;&#x5B9E;&#x4E5F;&#x53EF;&#x4EE5;&#x5206;&#x4E09;&#x6B65;&#x505A;&#xFF0C;&#x7B2C;&#x4E00;&#x6B65;&#x751F;&#x6210;&#x6C47;&#x7F16;&#x4EE3;&#x7801;&#xFF0C;&#x7B2C;&#x4E8C;&#x6B65;&#x751F;&#x6210;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#xFF0C;&#x7B2C;&#x4E09;&#x6B65;&#x751F;&#x6210;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#xFF1A;</p><pre class="screen">$ gcc -S main.c
$ gcc -c main.s
$ gcc main.o</pre><p><code class="literal">-S</code>&#x9009;&#x9879;&#x751F;&#x6210;&#x6C47;&#x7F16;&#x4EE3;&#x7801;&#xFF0C;<code class="literal">-c</code>&#x9009;&#x9879;&#x751F;&#x6210;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#xFF0C;&#x6B64;&#x5916;&#x5728;<a class="xref" href="ch08s02.html#array.statistic">&#x7B2C;&#xA0;2&#xA0;&#x8282; &#x201C;&#x6570;&#x7EC4;&#x5E94;&#x7528;&#x5B9E;&#x4F8B;&#xFF1A;&#x7EDF;&#x8BA1;&#x968F;&#x673A;&#x6570;&#x201D;</a>&#x8FD8;&#x8BB2;&#x8FC7;<code class="literal">-E</code>&#x9009;&#x9879;&#x53EA;&#x505A;&#x9884;&#x5904;&#x7406;&#x800C;&#x4E0D;&#x7F16;&#x8BD1;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x52A0;&#x8FD9;&#x4E9B;&#x9009;&#x9879;&#x5219;<code class="literal">gcc</code>&#x6267;&#x884C;&#x5B8C;&#x6574;&#x7684;&#x7F16;&#x8BD1;&#x6B65;&#x9AA4;&#xFF0C;&#x76F4;&#x5230;&#x6700;&#x540E;&#x94FE;&#x63A5;&#x751F;&#x6210;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4E3A;&#x6B62;&#x3002;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#x3002;</p><div class="figure"><a id="id2776267"></a><p class="title"><b>&#x56FE;&#xA0;19.2.&#xA0;gcc&#x547D;&#x4EE4;&#x7684;&#x9009;&#x9879;</b></p><div class="figure-contents"><div><img src="images/asmc.gcc.png" alt="gcc&#x547D;&#x4EE4;&#x7684;&#x9009;&#x9879;"></div></div></div><br class="figure-break"><p>&#x8FD9;&#x4E9B;&#x9009;&#x9879;&#x90FD;&#x53EF;&#x4EE5;&#x548C;<code class="literal">-o</code>&#x642D;&#x914D;&#x4F7F;&#x7528;&#xFF0C;&#x7ED9;&#x8F93;&#x51FA;&#x7684;&#x6587;&#x4EF6;&#x91CD;&#x65B0;&#x547D;&#x540D;&#x800C;&#x4E0D;&#x4F7F;&#x7528;<code class="literal">gcc</code>&#x9ED8;&#x8BA4;&#x7684;&#x6587;&#x4EF6;&#x540D;&#xFF08;<code class="literal">xxx.c</code>&#x3001;<code class="literal">xxx.s</code>&#x3001;<code class="literal">xxx.o</code>&#x548C;<code class="literal">a.out</code>&#xFF09;&#xFF0C;&#x4F8B;&#x5982;<code class="literal">gcc main.o -o main</code>&#x5C06;<code class="literal">main.o</code>&#x94FE;&#x63A5;&#x6210;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;<code class="literal">main</code>&#x3002;&#x5148;&#x524D;&#x7531;&#x6C47;&#x7F16;&#x4EE3;&#x7801;<a class="xref" href="ch18s01.html#asm.simpleasm">&#x4F8B;&#xA0;18.1 &#x201C;&#x6700;&#x7B80;&#x5355;&#x7684;&#x6C47;&#x7F16;&#x7A0B;&#x5E8F;&#x201D;</a>&#x751F;&#x6210;&#x7684;&#x76EE;&#x6807;&#x6587;&#x4EF6;<code class="literal">hello.o</code>&#x6211;&#x4EEC;&#x662F;&#x7528;<code class="literal">ld</code>&#x6765;&#x94FE;&#x63A5;&#x7684;&#xFF0C;&#x53EF;&#x4E0D;&#x53EF;&#x4EE5;&#x7528;<code class="literal">gcc</code>&#x94FE;&#x63A5;&#x5462;&#xFF1F;&#x8BD5;&#x8BD5;&#x770B;&#x3002;</p><pre class="screen">$ gcc hello.o -o hello
hello.o: In function `_start&apos;:
(.text+0x0): multiple definition of `_start&apos;
/usr/lib/gcc/i486-linux-gnu/4.3.2/../../../../lib/crt1.o:(.text+0x0): first defined here
/usr/lib/gcc/i486-linux-gnu/4.3.2/../../../../lib/crt1.o: In function `_start&apos;:
(.text+0x18): undefined reference to `main&apos;
collect2: ld returned 1 exit status</pre><p>&#x63D0;&#x793A;&#x4E24;&#x4E2A;&#x9519;&#x8BEF;&#xFF1A;&#x4E00;&#x662F;<code class="literal">_start</code>&#x6709;&#x591A;&#x4E2A;&#x5B9A;&#x4E49;&#xFF0C;&#x4E00;&#x4E2A;&#x5B9A;&#x4E49;&#x662F;&#x7531;&#x6211;&#x4EEC;&#x7684;&#x6C47;&#x7F16;&#x4EE3;&#x7801;&#x63D0;&#x4F9B;&#x7684;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x5B9A;&#x4E49;&#x6765;&#x81EA;<code class="literal">/usr/lib/crt1.o</code>&#xFF1B;&#x4E8C;&#x662F;<code class="literal">crt1.o</code>&#x7684;<code class="literal">_start</code>&#x51FD;&#x6570;&#x8981;&#x8C03;&#x7528;<code class="literal">main</code>&#x51FD;&#x6570;&#xFF0C;&#x800C;&#x6211;&#x4EEC;&#x7684;&#x6C47;&#x7F16;&#x4EE3;&#x7801;&#x4E2D;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;<code class="literal">main</code>&#x51FD;&#x6570;&#x7684;&#x5B9A;&#x4E49;&#x3002;&#x4ECE;&#x6700;&#x540E;&#x4E00;&#x884C;&#x8FD8;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x8FD9;&#x4E9B;&#x9519;&#x8BEF;&#x63D0;&#x793A;&#x662F;&#x7531;<code class="literal">ld</code>&#x7ED9;&#x51FA;&#x7684;&#x3002;&#x7531;&#x6B64;&#x53EF;&#x89C1;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x7528;<code class="literal">gcc</code>&#x505A;&#x94FE;&#x63A5;&#xFF0C;<code class="literal">gcc</code>&#x5176;&#x5B9E;&#x662F;&#x8C03;&#x7528;<code class="literal">ld</code>&#x5C06;&#x76EE;&#x6807;&#x6587;&#x4EF6;<code class="literal">crt1.o</code>&#x548C;&#x6211;&#x4EEC;&#x7684;<code class="literal">hello.o</code>&#x94FE;&#x63A5;&#x5728;&#x4E00;&#x8D77;&#x3002;<code class="literal">crt1.o</code>&#x91CC;&#x9762;&#x5DF2;&#x7ECF;&#x63D0;&#x4F9B;&#x4E86;<code class="literal">_start</code>&#x5165;&#x53E3;&#x70B9;&#xFF0C;&#x6211;&#x4EEC;&#x7684;&#x6C47;&#x7F16;&#x7A0B;&#x5E8F;&#x4E2D;&#x518D;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;<code class="literal">_start</code>&#x5C31;&#x662F;&#x591A;&#x91CD;&#x5B9A;&#x4E49;&#x4E86;&#xFF0C;&#x94FE;&#x63A5;&#x5668;&#x4E0D;&#x77E5;&#x9053;&#x8BE5;&#x7528;&#x54EA;&#x4E2A;&#xFF0C;&#x53EA;&#x597D;&#x62A5;&#x9519;&#x3002;&#x53E6;&#x5916;&#xFF0C;<code class="literal">crt1.o</code>&#x63D0;&#x4F9B;&#x7684;<code class="literal">_start</code>&#x9700;&#x8981;&#x8C03;&#x7528;<code class="literal">main</code>&#x51FD;&#x6570;&#xFF0C;&#x800C;&#x6211;&#x4EEC;&#x7684;&#x6C47;&#x7F16;&#x7A0B;&#x5E8F;&#x4E2D;&#x6CA1;&#x6709;&#x5B9E;&#x73B0;<code class="literal">main</code>&#x51FD;&#x6570;&#xFF0C;&#x6240;&#x4EE5;&#x62A5;&#x9519;&#x3002;</p><p>&#x5982;&#x679C;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x662F;&#x7531;C&#x4EE3;&#x7801;&#x7F16;&#x8BD1;&#x751F;&#x6210;&#x7684;&#xFF0C;&#x7528;<code class="literal">gcc</code>&#x505A;&#x94FE;&#x63A5;&#x5C31;&#x6CA1;&#x9519;&#x4E86;&#xFF0C;&#x6574;&#x4E2A;&#x7A0B;&#x5E8F;&#x7684;&#x5165;&#x53E3;&#x70B9;&#x662F;<code class="literal">crt1.o</code>&#x4E2D;&#x63D0;&#x4F9B;&#x7684;<code class="literal">_start</code>&#xFF0C;&#x5B83;&#x9996;&#x5148;&#x505A;&#x4E00;&#x4E9B;&#x521D;&#x59CB;&#x5316;&#x5DE5;&#x4F5C;&#xFF08;&#x4EE5;&#x4E0B;&#x79F0;&#x4E3A;&#x542F;&#x52A8;&#x4F8B;&#x7A0B;&#xFF0C;Startup Routine<a id="id2776521" class="indexterm"></a>&#xFF09;&#xFF0C;&#x7136;&#x540E;&#x8C03;&#x7528;C&#x4EE3;&#x7801;&#x4E2D;&#x63D0;&#x4F9B;&#x7684;<code class="literal">main</code>&#x51FD;&#x6570;&#x3002;&#x6240;&#x4EE5;&#xFF0C;&#x4EE5;&#x524D;&#x6211;&#x4EEC;&#x8BF4;<code class="literal">main</code>&#x51FD;&#x6570;&#x662F;&#x7A0B;&#x5E8F;&#x7684;&#x5165;&#x53E3;&#x70B9;&#x5176;&#x5B9E;&#x4E0D;&#x51C6;&#x786E;&#xFF0C;<code class="literal">_start</code>&#x624D;&#x662F;&#x771F;&#x6B63;&#x7684;&#x5165;&#x53E3;&#x70B9;&#xFF0C;&#x800C;<code class="literal">main</code>&#x51FD;&#x6570;&#x662F;&#x88AB;<code class="literal">_start</code>&#x8C03;&#x7528;&#x7684;&#x3002;</p><p>&#x6211;&#x4EEC;&#x7EE7;&#x7EED;&#x7814;&#x7A76;&#x4E0A;&#x4E00;&#x8282;&#x7684;<a class="xref" href="ch19s01.html#asmc.func">&#x4F8B;&#xA0;19.1 &#x201C;&#x7814;&#x7A76;&#x51FD;&#x6570;&#x7684;&#x8C03;&#x7528;&#x8FC7;&#x7A0B;&#x201D;</a>&#x3002;&#x5982;&#x679C;&#x5206;&#x4E24;&#x6B65;&#x7F16;&#x8BD1;&#xFF0C;&#x7B2C;&#x4E8C;&#x6B65;<code class="literal">gcc main.o -o main</code>&#x5176;&#x5B9E;&#x662F;&#x8C03;&#x7528;<code class="literal">ld</code>&#x505A;&#x94FE;&#x63A5;&#x7684;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E;&#x8FD9;&#x6837;&#x7684;&#x547D;&#x4EE4;&#xFF1A;</p><pre class="screen">$ ld /usr/lib/crt1.o /usr/lib/crti.o main.o -o main -lc -dynamic-linker /lib/ld-linux.so.2</pre><p>&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x9664;&#x4E86;<code class="literal">crt1.o</code>&#x4E4B;&#x5916;&#x5176;&#x5B9E;&#x8FD8;&#x6709;<code class="literal">crti.o</code>&#xFF0C;&#x8FD9;&#x4E24;&#x4E2A;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x548C;&#x6211;&#x4EEC;&#x7684;<code class="literal">main.o</code>&#x94FE;&#x63A5;&#x5728;&#x4E00;&#x8D77;&#x751F;&#x6210;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;<code class="literal">main</code>&#x3002;<code class="literal">-lc</code>&#x8868;&#x793A;&#x9700;&#x8981;&#x94FE;&#x63A5;<code class="literal">libc</code>&#x5E93;&#xFF0C;&#x5728;<a class="xref" href="ch03s01.html#func.mathfunc">&#x7B2C;&#xA0;1&#xA0;&#x8282; &#x201C;&#x6570;&#x5B66;&#x51FD;&#x6570;&#x201D;</a>&#x8BB2;&#x8FC7;<code class="literal">-lc</code>&#x9009;&#x9879;&#x662F;<code class="literal">gcc</code>&#x9ED8;&#x8BA4;&#x7684;&#xFF0C;&#x4E0D;&#x7528;&#x5199;&#xFF0C;&#x800C;&#x5BF9;&#x4E8E;<code class="literal">ld</code>&#x5219;&#x4E0D;&#x662F;&#x9ED8;&#x8BA4;&#x9009;&#x9879;&#xFF0C;&#x6240;&#x4EE5;&#x8981;&#x5199;&#x4E0A;&#x3002;<code class="literal">-dynamic-linker /lib/ld-linux.so.2</code>&#x6307;&#x5B9A;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x662F;<code class="literal">/lib/ld-linux.so.2</code>&#xFF0C;&#x7A0D;&#x540E;&#x4F1A;&#x89E3;&#x91CA;&#x4EC0;&#x4E48;&#x662F;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x3002;</p><p>&#x90A3;&#x4E48;<code class="literal">crt1.o</code>&#x548C;<code class="literal">crti.o</code>&#x91CC;&#x9762;&#x90FD;&#x6709;&#x4EC0;&#x4E48;&#x5462;&#xFF1F;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x7528;<code class="literal">readelf</code>&#x547D;&#x4EE4;&#x67E5;&#x770B;&#x3002;&#x5728;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x53EA;&#x5173;&#x5FC3;&#x7B26;&#x53F7;&#x8868;&#xFF0C;&#x5982;&#x679C;&#x53EA;&#x770B;&#x7B26;&#x53F7;&#x8868;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;<code class="literal">readelf</code>&#x547D;&#x4EE4;&#x7684;<code class="literal">-s</code>&#x9009;&#x9879;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x7528;<code class="literal">nm</code>&#x547D;&#x4EE4;&#x3002;</p><pre class="screen">$ nm /usr/lib/crt1.o 
00000000 R _IO_stdin_used
00000000 D __data_start
         U __libc_csu_fini
         U __libc_csu_init
         U __libc_start_main
00000000 R _fp_hw
00000000 T _start
00000000 W data_start
         U main
$ nm /usr/lib/crti.o
         U _GLOBAL_OFFSET_TABLE_
         w __gmon_start__
00000000 T _fini
00000000 T _init</pre><p><code class="literal">U main</code>&#x8FD9;&#x4E00;&#x884C;&#x8868;&#x793A;<code class="literal">main</code>&#x8FD9;&#x4E2A;&#x7B26;&#x53F7;&#x5728;<code class="literal">crt1.o</code>&#x4E2D;&#x7528;&#x5230;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x6CA1;&#x6709;&#x5B9A;&#x4E49;&#xFF08;U&#x8868;&#x793A;Undefined&#xFF09;&#xFF0C;&#x56E0;&#x6B64;&#x9700;&#x8981;&#x522B;&#x7684;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x5B9A;&#x4E49;&#x5E76;&#x4E14;&#x548C;<code class="literal">crt1.o</code>&#x94FE;&#x63A5;&#x5728;&#x4E00;&#x8D77;&#x3002;&#x5177;&#x4F53;&#x6765;&#x8BF4;&#xFF0C;&#x5728;<code class="literal">crt1.o</code>&#x4E2D;&#x8981;&#x7528;&#x5230;<code class="literal">main</code>&#x8FD9;&#x4E2A;&#x7B26;&#x53F7;&#x6240;&#x4EE3;&#x8868;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x4F8B;&#x5982;&#x6709;&#x4E00;&#x6761;&#x6307;&#x4EE4;&#x662F;<code class="literal">push $&#x7B26;&#x53F7;main&#x6240;&#x4EE3;&#x8868;&#x7684;&#x5730;&#x5740;</code>&#xFF0C;&#x4F46;&#x4E0D;&#x77E5;&#x9053;&#x8FD9;&#x4E2A;&#x5730;&#x5740;&#x662F;&#x591A;&#x5C11;&#xFF0C;&#x6240;&#x4EE5;&#x5728;<code class="literal">crt1.o</code>&#x4E2D;&#x8FD9;&#x6761;&#x6307;&#x4EE4;&#x6682;&#x65F6;&#x5199;&#x6210;<code class="literal">push $0x0</code>&#xFF0C;&#x7B49;&#x5230;&#x548C;<code class="literal">main.o</code>&#x94FE;&#x63A5;&#x6210;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x65F6;&#x5C31;&#x77E5;&#x9053;&#x8FD9;&#x4E2A;&#x5730;&#x5740;&#x662F;&#x591A;&#x5C11;&#x4E86;&#xFF0C;&#x6BD4;&#x5982;&#x662F;0x80483c4&#xFF0C;&#x90A3;&#x4E48;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;<code class="literal">main</code>&#x4E2D;&#x7684;&#x8FD9;&#x6761;&#x6307;&#x4EE4;&#x5C31;&#x88AB;&#x94FE;&#x63A5;&#x5668;&#x6539;&#x6210;&#x4E86;<code class="literal">push $0x80483c4</code>&#x3002;&#x94FE;&#x63A5;&#x5668;&#x5728;&#x8FD9;&#x91CC;&#x8D77;&#x5230;&#x7B26;&#x53F7;&#x89E3;&#x6790;&#xFF08;Symbol Resolution&#xFF09;&#x7684;&#x4F5C;&#x7528;&#xFF0C;&#x5728;<a class="xref" href="ch18s05.html#asm.executable">&#x7B2C;&#xA0;5.2&#xA0;&#x8282; &#x201C;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x201D;</a>&#x6211;&#x4EEC;&#x770B;&#x5230;&#x94FE;&#x63A5;&#x5668;&#x8D77;&#x5230;&#x91CD;&#x5B9A;&#x4F4D;&#x7684;&#x4F5C;&#x7528;&#xFF0C;&#x8FD9;&#x4E24;&#x79CD;&#x4F5C;&#x7528;&#x90FD;&#x662F;&#x901A;&#x8FC7;&#x4FEE;&#x6539;&#x6307;&#x4EE4;&#x4E2D;&#x7684;&#x5730;&#x5740;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x94FE;&#x63A5;&#x5668;&#x4E5F;&#x662F;&#x4E00;&#x79CD;&#x7F16;&#x8F91;&#x5668;&#xFF0C;<code class="literal">vi</code>&#x548C;<code class="literal">emacs</code>&#x7F16;&#x8F91;&#x7684;&#x662F;&#x6E90;&#x6587;&#x4EF6;&#xFF0C;&#x800C;&#x94FE;&#x63A5;&#x5668;&#x7F16;&#x8F91;&#x7684;&#x662F;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#xFF0C;&#x6240;&#x4EE5;&#x94FE;&#x63A5;&#x5668;&#x4E5F;&#x53EB;Link Editor&#x3002;<code class="literal">T _start</code>&#x8FD9;&#x4E00;&#x884C;&#x8868;&#x793A;<code class="literal">_start</code>&#x8FD9;&#x4E2A;&#x7B26;&#x53F7;&#x5728;<code class="literal">crt1.o</code>&#x4E2D;&#x63D0;&#x4F9B;&#x4E86;&#x5B9A;&#x4E49;&#xFF0C;&#x8FD9;&#x4E2A;&#x7B26;&#x53F7;&#x7684;&#x7C7B;&#x578B;&#x662F;&#x4EE3;&#x7801;&#xFF08;T&#x8868;&#x793A;Text&#xFF09;&#x3002;&#x6211;&#x4EEC;&#x4ECE;&#x4E0A;&#x9762;&#x7684;&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#x4E2D;&#x9009;&#x53D6;&#x51E0;&#x4E2A;&#x7B26;&#x53F7;&#x7528;&#x56FE;&#x793A;&#x8BF4;&#x660E;&#x5B83;&#x4EEC;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;&#xFF1A;</p><div class="figure"><a id="id2776845"></a><p class="title"><b>&#x56FE;&#xA0;19.3.&#xA0;C&#x7A0B;&#x5E8F;&#x7684;&#x94FE;&#x63A5;&#x8FC7;&#x7A0B;</b></p><div class="figure-contents"><div><img src="images/asmc.link.png" alt="C&#x7A0B;&#x5E8F;&#x7684;&#x94FE;&#x63A5;&#x8FC7;&#x7A0B;"></div></div></div><br class="figure-break"><p>&#x5176;&#x5B9E;&#x4E0A;&#x9762;&#x6211;&#x4EEC;&#x5199;&#x7684;<code class="literal">ld</code>&#x547D;&#x4EE4;&#x505A;&#x4E86;&#x5F88;&#x591A;&#x7B80;&#x5316;&#xFF0C;<code class="literal">gcc</code>&#x5728;&#x94FE;&#x63A5;&#x65F6;&#x8FD8;&#x7528;&#x5230;&#x4E86;&#x53E6;&#x5916;&#x51E0;&#x4E2A;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#xFF0C;&#x6240;&#x4EE5;&#x4E0A;&#x56FE;&#x591A;&#x753B;&#x4E86;&#x4E00;&#x4E2A;&#x6846;&#xFF0C;&#x8868;&#x793A;&#x7EC4;&#x6210;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;<code class="literal">main</code>&#x7684;&#x9664;&#x4E86;<code class="literal">main.o</code>&#x3001;<code class="literal">crt1.o</code>&#x548C;<code class="literal">crti.o</code>&#x4E4B;&#x5916;&#x8FD8;&#x6709;&#x5176;&#x5B83;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#xFF0C;&#x672C;&#x4E66;&#x4E0D;&#x505A;&#x6DF1;&#x5165;&#x8BA8;&#x8BBA;&#xFF0C;&#x7528;<code class="literal">gcc</code>&#x7684;<code class="literal">-v</code>&#x9009;&#x9879;&#x53EF;&#x4EE5;&#x4E86;&#x89E3;&#x8BE6;&#x7EC6;&#x7684;&#x7F16;&#x8BD1;&#x8FC7;&#x7A0B;&#xFF1A;</p><pre class="screen">$ gcc -v main.c -o main
Using built-in specs.
Target: i486-linux-gnu
...
 /usr/lib/gcc/i486-linux-gnu/4.3.2/cc1 -quiet -v main.c -D_FORTIFY_SOURCE=2 -quiet -dumpbase main.c -mtune=generic -auxbase main -version -fstack-protector -o /tmp/ccRGDpua.s
...
 as -V -Qy -o /tmp/ccidnZ1d.o /tmp/ccRGDpua.s
...
 /usr/lib/gcc/i486-linux-gnu/4.3.2/collect2 --eh-frame-hdr -m elf_i386 --hash-style=both -dynamic-linker /lib/ld-linux.so.2 -o main -z relro /usr/lib/gcc/i486-linux-gnu/4.3.2/../../../../lib/crt1.o /usr/lib/gcc/i486-linux-gnu/4.3.2/../../../../lib/crti.o /usr/lib/gcc/i486-linux-gnu/4.3.2/crtbegin.o -L/usr/lib/gcc/i486-linux-gnu/4.3.2 -L/usr/lib/gcc/i486-linux-gnu/4.3.2 -L/usr/lib/gcc/i486-linux-gnu/4.3.2/../../../../lib -L/lib/../lib -L/usr/lib/../lib -L/usr/lib/gcc/i486-linux-gnu/4.3.2/../../.. /tmp/ccidnZ1d.o -lgcc --as-needed -lgcc_s --no-as-needed -lc -lgcc --as-needed -lgcc_s --no-as-needed /usr/lib/gcc/i486-linux-gnu/4.3.2/crtend.o /usr/lib/gcc/i486-linux-gnu/4.3.2/../../../../lib/crtn.o</pre><p>&#x94FE;&#x63A5;&#x751F;&#x6210;&#x7684;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;<code class="literal">main</code>&#x4E2D;&#x5305;&#x542B;&#x4E86;&#x5404;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x6240;&#x5B9A;&#x4E49;&#x7684;&#x7B26;&#x53F7;&#xFF0C;&#x901A;&#x8FC7;&#x53CD;&#x6C47;&#x7F16;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x8FD9;&#x4E9B;&#x7B26;&#x53F7;&#x7684;&#x5B9A;&#x4E49;&#xFF1A;</p><pre class="screen">$ objdump -d main
main:     file format elf32-i386


Disassembly of section .init:

08048274 &lt;_init&gt;:
 8048274:	55                   	push   %ebp
 8048275:	89 e5                	mov    %esp,%ebp
 8048277:	53                   	push   %ebx
...
Disassembly of section .text:

080482e0 &lt;_start&gt;:
 80482e0:	31 ed                	xor    %ebp,%ebp
 80482e2:	5e                   	pop    %esi
 80482e3:	89 e1                	mov    %esp,%ecx
...
08048394 &lt;bar&gt;:
 8048394:	55                   	push   %ebp
 8048395:	89 e5                	mov    %esp,%ebp
 8048397:	83 ec 10             	sub    $0x10,%esp
...
080483aa &lt;foo&gt;:
 80483aa:	55                   	push   %ebp
 80483ab:	89 e5                	mov    %esp,%ebp
 80483ad:	83 ec 08             	sub    $0x8,%esp
...
080483c4 &lt;main&gt;:
 80483c4:	8d 4c 24 04          	lea    0x4(%esp),%ecx
 80483c8:	83 e4 f0             	and    $0xfffffff0,%esp
 80483cb:	ff 71 fc             	pushl  -0x4(%ecx)
...
Disassembly of section .fini:

0804849c &lt;_fini&gt;:
 804849c:	55                   	push   %ebp
 804849d:	89 e5                	mov    %esp,%ebp
 804849f:	53                   	push   %ebx</pre><p><code class="literal">crt1.o</code>&#x4E2D;&#x7684;&#x672A;&#x5B9A;&#x4E49;&#x7B26;&#x53F7;<code class="literal">main</code>&#x5728;<code class="literal">main.o</code>&#x4E2D;&#x5B9A;&#x4E49;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x94FE;&#x63A5;&#x5728;&#x4E00;&#x8D77;&#x5C31;&#x6CA1;&#x95EE;&#x9898;&#x4E86;&#x3002;<code class="literal">crt1.o</code>&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x672A;&#x5B9A;&#x4E49;&#x7B26;&#x53F7;<code class="literal">__libc_start_main</code>&#x5728;&#x5176;&#x5B83;&#x51E0;&#x4E2A;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x4E2D;&#x4E5F;&#x6CA1;&#x6709;&#x5B9A;&#x4E49;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;<code class="literal">main</code>&#x4E2D;&#x4ECD;&#x7136;&#x662F;&#x4E2A;&#x672A;&#x5B9A;&#x4E49;&#x7B26;&#x53F7;&#x3002;&#x8FD9;&#x4E2A;&#x7B26;&#x53F7;&#x662F;&#x5728;<code class="literal">libc</code>&#x4E2D;&#x5B9A;&#x4E49;&#x7684;&#xFF0C;<code class="literal">libc</code>&#x5E76;&#x4E0D;&#x50CF;&#x5176;&#x5B83;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x4E00;&#x6837;&#x94FE;&#x63A5;&#x5230;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;<code class="literal">main</code>&#x4E2D;&#xFF0C;&#x800C;&#x662F;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x505A;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#xFF1A;</p><div class="orderedlist"><ol type="1"><li><p>&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5728;&#x52A0;&#x8F7D;&#x6267;&#x884C;<code class="literal">main</code>&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x65F6;&#xFF0C;&#x9996;&#x5148;&#x67E5;&#x770B;&#x5B83;&#x6709;&#x6CA1;&#x6709;&#x9700;&#x8981;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x7684;&#x672A;&#x5B9A;&#x4E49;&#x7B26;&#x53F7;&#x3002;</p></li><li><p>&#x5982;&#x679C;&#x9700;&#x8981;&#x505A;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#xFF0C;&#x5C31;&#x67E5;&#x770B;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x6307;&#x5B9A;&#x4E86;&#x54EA;&#x4E9B;&#x5171;&#x4EAB;&#x5E93;&#xFF08;&#x6211;&#x4EEC;&#x7528;<code class="literal">-lc</code>&#x6307;&#x5B9A;&#x4E86;<code class="literal">libc</code>&#xFF09;&#x4EE5;&#x53CA;&#x7528;&#x4EC0;&#x4E48;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x6765;&#x505A;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#xFF08;&#x6211;&#x4EEC;&#x7528;<code class="literal">-dynamic-linker /lib/ld-linux.so.2</code>&#x6307;&#x5B9A;&#x4E86;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#xFF09;&#x3002;</p></li><li><p>&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x5728;&#x5171;&#x4EAB;&#x5E93;&#x4E2D;&#x67E5;&#x627E;&#x8FD9;&#x4E9B;&#x7B26;&#x53F7;&#x7684;&#x5B9A;&#x4E49;&#xFF0C;&#x5B8C;&#x6210;&#x94FE;&#x63A5;&#x8FC7;&#x7A0B;&#x3002;</p></li></ol></div><p>&#x4E86;&#x89E3;&#x4E86;&#x8FD9;&#x4E9B;&#x539F;&#x7406;&#x4E4B;&#x540E;&#xFF0C;&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x6765;&#x770B;<code class="literal">_start</code>&#x7684;&#x53CD;&#x6C47;&#x7F16;&#xFF1A;</p><pre class="screen">...
Disassembly of section .text:

080482e0 &lt;_start&gt;:
 80482e0:       31 ed                   xor    %ebp,%ebp
 80482e2:       5e                      pop    %esi
 80482e3:       89 e1                   mov    %esp,%ecx
 80482e5:       83 e4 f0                and    $0xfffffff0,%esp
 80482e8:       50                      push   %eax
 80482e9:       54                      push   %esp
 80482ea:       52                      push   %edx
 80482eb:       68 00 84 04 08          push   $0x8048400
 80482f0:       68 10 84 04 08          push   $0x8048410
 80482f5:       51                      push   %ecx
 80482f6:       56                      push   %esi
 80482f7:       68 c4 83 04 08          push   $0x80483c4
 80482fc:       e8 c3 ff ff ff          call   80482c4 &lt;__libc_start_main@plt&gt;
...</pre><p>&#x9996;&#x5148;&#x5C06;&#x4E00;&#x7CFB;&#x5217;&#x53C2;&#x6570;&#x538B;&#x6808;&#xFF0C;&#x7136;&#x540E;&#x8C03;&#x7528;<code class="literal">libc</code>&#x7684;&#x5E93;&#x51FD;&#x6570;<code class="literal">__libc_start_main</code>&#x505A;&#x521D;&#x59CB;&#x5316;&#x5DE5;&#x4F5C;&#xFF0C;&#x5176;&#x4E2D;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x538B;&#x6808;&#x7684;&#x53C2;&#x6570;<code class="literal">push   $0x80483c4</code>&#x662F;<code class="literal">main</code>&#x51FD;&#x6570;&#x7684;&#x5730;&#x5740;&#xFF0C;<code class="literal">__libc_start_main</code>&#x5728;&#x5B8C;&#x6210;&#x521D;&#x59CB;&#x5316;&#x5DE5;&#x4F5C;&#x4E4B;&#x540E;&#x4F1A;&#x8C03;&#x7528;<code class="literal">main</code>&#x51FD;&#x6570;&#x3002;&#x7531;&#x4E8E;<code class="literal">__libc_start_main</code>&#x9700;&#x8981;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x4E2A;&#x5E93;&#x51FD;&#x6570;&#x7684;&#x6307;&#x4EE4;&#x5728;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;<code class="literal">main</code>&#x7684;&#x53CD;&#x6C47;&#x7F16;&#x4E2D;&#x80AF;&#x5B9A;&#x662F;&#x627E;&#x4E0D;&#x5230;&#x7684;&#xFF0C;&#x7136;&#x800C;&#x6211;&#x4EEC;&#x627E;&#x5230;&#x4E86;&#x8FD9;&#x4E2A;&#xFF1A;</p><pre class="screen">Disassembly of section .plt:
...
080482c4 &lt;__libc_start_main@plt&gt;:
 80482c4:       ff 25 04 a0 04 08       jmp    *0x804a004
 80482ca:       68 08 00 00 00          push   $0x8
 80482cf:       e9 d0 ff ff ff          jmp    80482a4 &lt;_init+0x30&gt;</pre><p>&#x8FD9;&#x4E09;&#x6761;&#x6307;&#x4EE4;&#x4F4D;&#x4E8E;<code class="literal">.plt</code>&#x6BB5;&#x800C;&#x4E0D;&#x662F;<code class="literal">.text</code>&#x6BB5;&#xFF0C;<code class="literal">.plt</code>&#x6BB5;&#x534F;&#x52A9;&#x5B8C;&#x6210;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x7684;&#x8FC7;&#x7A0B;&#x3002;&#x6211;&#x4EEC;&#x5C06;&#x5728;&#x4E0B;&#x4E00;&#x7AE0;&#x8BE6;&#x7EC6;&#x8BB2;&#x89E3;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x7684;&#x8FC7;&#x7A0B;&#x3002;</p><p><code class="literal">main</code>&#x51FD;&#x6570;&#x6700;&#x6807;&#x51C6;&#x7684;&#x539F;&#x578B;&#x5E94;&#x8BE5;&#x662F;<code class="literal">int main(int argc, char *argv[])</code>&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x542F;&#x52A8;&#x4F8B;&#x7A0B;&#x4F1A;&#x4F20;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#x7ED9;<code class="literal">main</code>&#x51FD;&#x6570;&#xFF0C;&#x8FD9;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x542B;&#x4E49;&#x6211;&#x4EEC;&#x5B66;&#x4E86;&#x6307;&#x9488;&#x4EE5;&#x540E;&#x518D;&#x89E3;&#x91CA;&#x3002;&#x6211;&#x4EEC;&#x5230;&#x76EE;&#x524D;&#x4E3A;&#x6B62;&#x90FD;&#x628A;<code class="literal">main</code>&#x51FD;&#x6570;&#x7684;&#x539F;&#x578B;&#x5199;&#x6210;<code class="literal">int main(void)</code>&#xFF0C;&#x8FD9;&#x4E5F;&#x662F;C&#x6807;&#x51C6;&#x5141;&#x8BB8;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x8BA4;&#x771F;&#x5206;&#x6790;&#x4E86;&#x4E0A;&#x4E00;&#x8282;&#x7684;&#x4E60;&#x9898;&#xFF0C;&#x4F60;&#x5C31;&#x5E94;&#x8BE5;&#x77E5;&#x9053;&#xFF0C;&#x591A;&#x4F20;&#x4E86;&#x53C2;&#x6570;&#x800C;&#x4E0D;&#x7528;&#x662F;&#x6CA1;&#x6709;&#x95EE;&#x9898;&#x7684;&#xFF0C;&#x5C11;&#x4F20;&#x4E86;&#x53C2;&#x6570;&#x5374;&#x7528;&#x4E86;&#x5219;&#x4F1A;&#x51FA;&#x95EE;&#x9898;&#x3002;</p><p>&#x7531;&#x4E8E;<code class="literal">main</code>&#x51FD;&#x6570;&#x662F;&#x88AB;&#x542F;&#x52A8;&#x4F8B;&#x7A0B;&#x8C03;&#x7528;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x4ECE;<code class="literal">main</code>&#x51FD;&#x6570;<code class="literal">return</code>&#x65F6;&#x4ECD;&#x8FD4;&#x56DE;&#x5230;&#x542F;&#x52A8;&#x4F8B;&#x7A0B;&#x4E2D;&#xFF0C;<code class="literal">main</code>&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x88AB;&#x542F;&#x52A8;&#x4F8B;&#x7A0B;&#x5F97;&#x5230;&#xFF0C;&#x5982;&#x679C;&#x5C06;&#x542F;&#x52A8;&#x4F8B;&#x7A0B;&#x8868;&#x793A;&#x6210;&#x7B49;&#x4EF7;&#x7684;C&#x4EE3;&#x7801;&#xFF08;&#x5B9E;&#x9645;&#x4E0A;&#x542F;&#x52A8;&#x4F8B;&#x7A0B;&#x4E00;&#x822C;&#x662F;&#x76F4;&#x63A5;&#x7528;&#x6C47;&#x7F16;&#x5199;&#x7684;&#xFF09;&#xFF0C;&#x5219;&#x5B83;&#x8C03;&#x7528;<code class="literal">main</code>&#x51FD;&#x6570;&#x7684;&#x5F62;&#x5F0F;&#x662F;&#xFF1A;</p><pre class="programlisting">exit(main(argc, argv));</pre><p>&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x542F;&#x52A8;&#x4F8B;&#x7A0B;&#x5F97;&#x5230;<code class="literal">main</code>&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x540E;&#xFF0C;&#x4F1A;&#x7ACB;&#x523B;&#x7528;&#x5B83;&#x505A;&#x53C2;&#x6570;&#x8C03;&#x7528;<code class="literal">exit</code>&#x51FD;&#x6570;&#x3002;<code class="literal">exit</code>&#x4E5F;&#x662F;<code class="literal">libc</code>&#x4E2D;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x5B83;&#x9996;&#x5148;&#x505A;&#x4E00;&#x4E9B;&#x6E05;&#x7406;&#x5DE5;&#x4F5C;&#xFF0C;&#x7136;&#x540E;&#x8C03;&#x7528;&#x4E0A;&#x4E00;&#x7AE0;&#x8BB2;&#x8FC7;&#x7684;<code class="literal">_exit</code>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7EC8;&#x6B62;&#x8FDB;&#x7A0B;&#xFF0C;<code class="literal">main</code>&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x6700;&#x7EC8;&#x88AB;&#x4F20;&#x7ED9;<code class="literal">_exit</code>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x6210;&#x4E3A;&#x8FDB;&#x7A0B;&#x7684;&#x9000;&#x51FA;&#x72B6;&#x6001;&#x3002;&#x6211;&#x4EEC;&#x4E5F;&#x53EF;&#x4EE5;&#x5728;<code class="literal">main</code>&#x51FD;&#x6570;&#x4E2D;&#x76F4;&#x63A5;&#x8C03;&#x7528;<code class="literal">exit</code>&#x51FD;&#x6570;&#x7EC8;&#x6B62;&#x8FDB;&#x7A0B;&#x800C;&#x4E0D;&#x8FD4;&#x56DE;&#x5230;&#x542F;&#x52A8;&#x4F8B;&#x7A0B;&#xFF0C;&#x4F8B;&#x5982;&#xFF1A;</p><pre class="programlisting">#include &lt;stdlib.h&gt;

int main(void)
{
	exit(4);
}</pre><p>&#x8FD9;&#x6837;&#x548C;<code class="literal">int main(void) { return 4; }</code>&#x7684;&#x6548;&#x679C;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;&#x5728;Shell&#x4E2D;&#x8FD0;&#x884C;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x5E76;&#x67E5;&#x770B;&#x5B83;&#x7684;&#x9000;&#x51FA;&#x72B6;&#x6001;&#xFF1A;</p><pre class="screen">$ ./a.out 
$ echo $?
4</pre><p>&#x6309;&#x7167;&#x60EF;&#x4F8B;&#xFF0C;&#x9000;&#x51FA;&#x72B6;&#x6001;&#x4E3A;0&#x8868;&#x793A;&#x7A0B;&#x5E8F;&#x6267;&#x884C;&#x6210;&#x529F;&#xFF0C;&#x9000;&#x51FA;&#x72B6;&#x6001;&#x975E;0&#x8868;&#x793A;&#x51FA;&#x9519;&#x3002;&#x6CE8;&#x610F;&#xFF0C;&#x9000;&#x51FA;&#x72B6;&#x6001;&#x53EA;&#x6709;8&#x4F4D;&#xFF0C;&#x800C;&#x4E14;&#x88AB;Shell&#x89E3;&#x91CA;&#x6210;&#x65E0;&#x7B26;&#x53F7;&#x6570;&#xFF0C;&#x5982;&#x679C;&#x5C06;&#x4E0A;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x6539;&#x4E3A;<code class="literal">exit(-1);</code>&#x6216;<code class="literal">return -1;</code>&#xFF0C;&#x5219;&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#x4E3A;</p><pre class="screen">$ ./a.out 
$ echo $?
255</pre><p>&#x6CE8;&#x610F;&#xFF0C;&#x5982;&#x679C;&#x58F0;&#x660E;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x7C7B;&#x578B;&#x662F;<code class="literal">int</code>&#xFF0C;&#x51FD;&#x6570;&#x4E2D;&#x6BCF;&#x4E2A;&#x5206;&#x652F;&#x63A7;&#x5236;&#x6D41;&#x7A0B;&#x5FC5;&#x987B;&#x5199;<code class="literal">return</code>&#x8BED;&#x53E5;&#x6307;&#x5B9A;&#x8FD4;&#x56DE;&#x503C;&#xFF0C;&#x5982;&#x679C;&#x7F3A;&#x4E86;<code class="literal">return</code>&#x5219;&#x8FD4;&#x56DE;&#x503C;&#x4E0D;&#x786E;&#x5B9A;&#xFF08;&#x60F3;&#x60F3;&#x8FD9;&#x662F;&#x4E3A;&#x4EC0;&#x4E48;&#xFF09;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x901A;&#x5E38;&#x662F;&#x4F1A;&#x62A5;&#x8B66;&#x544A;&#x7684;&#xFF0C;&#x4F46;&#x5982;&#x679C;&#x67D0;&#x4E2A;&#x5206;&#x652F;&#x63A7;&#x5236;&#x6D41;&#x7A0B;&#x8C03;&#x7528;&#x4E86;<code class="literal">exit</code>&#x6216;<code class="literal">_exit</code>&#x800C;&#x4E0D;&#x5199;<code class="literal">return</code>&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x662F;&#x5141;&#x8BB8;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x90FD;&#x6CA1;&#x6709;&#x673A;&#x4F1A;&#x8FD4;&#x56DE;&#x4E86;&#xFF0C;&#x6307;&#x4E0D;&#x6307;&#x5B9A;&#x8FD4;&#x56DE;&#x503C;&#x4E5F;&#x5C31;&#x65E0;&#x6240;&#x8C13;&#x4E86;&#x3002;&#x4F7F;&#x7528;<code class="literal">exit</code>&#x51FD;&#x6570;&#x9700;&#x8981;&#x5305;&#x542B;&#x5934;&#x6587;&#x4EF6;<code class="literal">stdlib.h</code>&#xFF0C;&#x800C;&#x4F7F;&#x7528;<code class="literal">_exit</code>&#x51FD;&#x6570;&#x9700;&#x8981;&#x5305;&#x542B;&#x5934;&#x6587;&#x4EF6;<code class="literal">unistd.h</code>&#xFF0C;&#x4EE5;&#x540E;&#x8FD8;&#x8981;&#x8BE6;&#x7EC6;&#x89E3;&#x91CA;&#x8FD9;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#x3002;</p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tbody><tr><td width="40%" align="left"><a accesskey="p" href="ch19s01.html">&#x4E0A;&#x4E00;&#x9875;</a>&#xA0;</td><td width="20%" align="center"><a accesskey="u" href="ch19.html">&#x4E0A;&#x4E00;&#x7EA7;</a></td><td width="40%" align="right">&#xA0;<a accesskey="n" href="ch19s03.html">&#x4E0B;&#x4E00;&#x9875;</a></td></tr><tr><td width="40%" align="left" valign="top">1.&#xA0;&#x51FD;&#x6570;&#x8C03;&#x7528;&#xA0;</td><td width="20%" align="center"><a accesskey="h" href="index.html">&#x8D77;&#x59CB;&#x9875;</a></td><td width="40%" align="right" valign="top">&#xA0;3.&#xA0;&#x53D8;&#x91CF;&#x7684;&#x5B58;&#x50A8;&#x5E03;&#x5C40;</td></tr></tbody></table></div>
</body></html>